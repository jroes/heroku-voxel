var alea = require('alea');
var SimplexNoise = require('./');
var test = require('tape');

var epsilon = 1e-12; // TODO

function fpequal(a, b) {
  return Math.abs(a - b) < epsilon;
}

test('noise2D', function(t) {
  var simplex = new SimplexNoise(new alea(1));

  var expectedArray = [[ -0.41165362812866246, -0.11370739418928094, 0.37341599438993434, -0.8524736396296171, 0.6488651702496718, 0.4989445745658423, -0.28899443148586745, -0.4357016575683777, -0.6889382156700798, 0.06613528234924561, 0.051281346765759184, 0, -0.17641740540869802, 0.15915828255685407, 0.40209723583720247, 0.3666694999034262, 0.4989247905504145, 0.47052992247168496, -0.012279858843358638, -0.3465103646672434 ]
, [ 0, -0.49821178815608025, -0.002773464581834986, -0.6488651702496718, -0.7340295545786081, 0.28899443148586745, -0.00566943667896693, 0.49733515245859483, 0.06613528234924561, 0.43979690246739767, -0.4323454794146864, 1.890024239983652e-15, 0.3396074300447006, 0.0014915986339128354, 0.3666694999034262, -0.4989247905504145, -0.23526496123584248, 0.46482743676222305, -0.5693861362999583, 0 ]
, [ -0.24959158753229177, -0.43039701668756103, -0.32443335784317806, -0.49894457456584385, 0, -0.4357016575683777, -0.49733515245859483, 3.871488047799157e-15, 0.38851555570164054, 0.47770703070953147, 0.17641740540869613, -0.18044914748784857, 0.8034486723574501, -0.00009109112611977807, 0.4989247905504145, 0.23526496123584248, 0.47710729560558174, -0.49509421242238577, 0, 0.27221844078966956 ]
, [ 0.433170481269396, -0.3244318124064908, 0.2638595945530765, 0.28899443148586745, 0.4357016575683777, -0.49733515245859483, 0, -0.05128134676575719, 0.4323454794146864, 0.17641740540869802, 0.4987657126015543, -0.0007457993169579564, -0.7333389998068517, -0.10636417890184266, 0.23526496123584248, -0.4648274367622214, 0.4950942124223866, 0, 0.07429192387757226, 0.012279858843361214 ]
, [ 0.32443284269761885, -0.2638595945530787, 0.5779888629717349, -0.8714033151367554, 0.5992458488742981, 0.06613528234924565, 0.4910782492331565, -0.8646909588293727, -0.17641740540869802, 0.4987657126015543, -0.4020972358372031, -0.366851682155665, -0.8015692752765431, -0.23526496123584248, 0, -0.4208022885448136, 0, 0.4208022885448141, 0.024559717686722427, -0.47052992247168474 ]
, [ -0.4989445745658432, -0.28899443148586745, -0.00566943667896693, 0, 0.06613528234924565, -0.9308751517005547, -0.4323454794146864, 0.17641740540869802, -0.1591582825568516, 0.0007457993169579564, 0.3665784087773057, -0.19628030582428593, -0.23526496123584248, -0.012279858843360988, -0.7673126532120541, 0, 0.34651036466724183, -0.4525475779188607, 0, 0.08991612692244662 ]
, [ 0.5779888629717349, 0.00566943667896693, 0.49733515245859483, 0.06613528234924565, -0.4910782492331565, 0.4323454794146864, -0.17641740540869613, 0.021290864930999485, -0.40135143652024513, 8.303884134536037e-16, -0.19628030582428593, 9.225595802028347e-16, -0.4525475779188604, -0.2722184407896676, 0, 0.4208022885448141, -0.4402677190754995, 0, 0.10636417890184044, 0.7336122731852096 ]
, [ 0.8940810618526231, -0.29351375962718834, -0.06613528234924561, -0.051281346765759094, -0.4323454794146864, 0.17641740540869613, 0.18044914748785107, 0.402843035154161, 0.00009109112611977807, 0.6952050963747004, -0.23526496123584156, 0.4525475779188604, -0.5693861362999592, 0, 0.5693861362999586, 0.024559717686723503, 0.23526496123584065, -0.39256061164857337, -0.36694277328178454, -0.4020972358372035 ]
, [ 0.10191069641570327, -0.06613528234924561, 0.49107824923315585, 0.4550262550621089, 0.17641740540869802, 0.18044914748785107, -0.8012112744065744, 0.3667605910295459, 0.08991612692244327, 0.23526496123584248, -0.8805354381509989, 0.4950942124223864, 0, -0.4950942124223863, -0.012279858843360988, -0.23526496123584065, -0.302644484726128, -0.36657840877730535, 0.0007457993169595129, -0.49876571260155383 ]
, [ 0.06613528234924561, 0.542359595998915, 0.47770703070953147, -0.35283481081739415, -0.1591582825568516, -0.4006056372032872, -0.36685168215566577, -0.4989247905504145, 0.23526496123584156, 0.9050951558377208, 0.4950942124223869, 0, 0.07429192387757272, -0.9173750146810818, -0.23526496123584156, -0.19628030582428685, 0.7336122731852102, -0.40209723583720197, 0.49876571260155433, -0.17641740540869807 ]
, [ 0.3885155557016396, -0.500387806356954, -0.17641740540869613, -0.6792148600894053, -0.4006056372032872, 0.7335211820590912, -0.6052889694522572, -9.225595802028347e-16, 0.44026771907549944, 0.42080228854481416, 0, 0.42080228854481416, -0.8805354381509989, 0.23526496123584065, -0.19628030582428593, -0.3669427732817843, -0.8027028730404896, -0.6579239951584049, 0, -0.47770703070953213 ]
, [ -0.500387806356954, 0.17641740540869802, 0.49876571260155517, 0.4006056372032872, -0.00018218225223872185, -0.10636417890184266, -0.23526496123584248, -0.012279858843360988, 0.9901884248447733, 0, 0.4950942124223869, 0.9173750146810818, -0.23526496123584156, 0.4989247905504145, -0.3667605910295448, 0.40060563720328607, 0.1804491474878531, 0.17641740540869802, -0.9327332857716413, -0.10256269353151563 ]
, [ 0.17641740540869802, 0.49876571260155395, 0.4020972358372056, 0.36657840877730646, 0.4989247905504145, -9.225595802028347e-16, 0.4525475779188604, -0.2722184407896677, 0, 0.3465103646672414, 0.44026771907549944, -0.4705299224716831, 0.10636417890184266, 0.3669427732817852, 0, 0.15915828255685063, -0.17641740540869802, 0.4323454794146863, 0.542359595998914, 0.0661352823492514 ]
, [ -0.021290864930995662, -0.0007457993169548446, -0.36685168215566566, 0.8015692752765431, 0, -0.4648274367622214, 0.9901884248447732, 0, 0.14858384775514452, 0.8928152969943598, 9.225595802028347e-16, -0.4989247905504145, -0.7336122731852102, -0.39985983788632923, -0.1804491474878531, 0, 0.4323454794146863, -0.3885155557016406, -0.13227056469849505, -0.8927596085014882 ]
, [ -0.4028430351541605, -0.36657840877730635, -0.3026444847261286, 0, -0.024559717686721976, -0.7673126532120541, 0, 0.4950942124223863, 0.44026771907549944, -0.23526496123584065, 0, 0.00009109112612060303, -0.4020972358372031, 0.15915828255685063, -0.35283481081739604, 0.47770703070953213, -0.3885155557016406, 0.06613528234924752, -0.29351375962718973, 0.4413710942473432 ]
, [ -0.3669427732817855, -0.8015692752765431, -0.23526496123584248, -0.4525475779188604, 0.4950942124223866, 0, -0.34651036466724183, -0.42798786023213764, 0.23526496123584065, -0.40900866362796945, 0.00018218225223871497, 0.401351436520244, 0.33960743004470373, 0.17641740540869802, -0.8646909588293726, 0.49107824923315624, 0.06613528234924752, 0.6889382156700818, -0.4413710942473451, -0.5779888629717379 ]
, [ -0.39256061164857187, -0.23526496123584248, -2.5723948050548447e-15, 0.4208022885448136, 0, 0, 0.012279858843361214, -0.23526496123584065, 0.4989247905504149, -0.366669499903425, 0.40060563720328607, -0.021290864931002462, 0, 0.47770703070953213, 0.43979690246739844, 0, 0.10191069641570248, -0.4470405309263122, -0.5779888629717379, 0.23508498001276523 ]
, [ -0.23526496123584248, 0.4525475779188594, 0.5693861362999582, 0, 0.767312653212056, 0, 0, -0.6052889694522559, 0.3668516821556647, -0.3998598378863281, 0.49876571260155433, 0, -0.45502625506210925, -0.10256269353151563, -0.06613528234924752, -0.20382139283140496, -0.4357016575683781, 0, 0.23508498001276523, 0.32443335784318217 ]
, [ -0.9296548735244439, -0.34651036466724117, 0, 0.9901884248447727, 0, 0.23526496123584065, 0.10636417890184044, -0.3668516821556647, 0.3998598378863297, 0.49876571260155433, 0, -0.5003878063569549, 0.3885155557016406, 0, 0.4973351524585946, 0.8940810618526244, 0, -0.23508498001276523, -0.32443335784318217, 0.42207662294205367 ]
, [ 0.4950942124223866, 0, -0.4208022885448141, 0.4402677190754995, -0.2352649612358405, 0.4989247905504145, -0.36676059102954495, -0.0007457993169563658, -0.4987657126015536, 0.17641740540869807, -0.9554140614190643, 0.05128134676575782, 0.0661352823492514, -0.4973351524585955, -0.4470405309263102, 0, 0.2638595945530778, 0.3244323275520576, 0.4248500875238884, 0.12479579376614507 ]];

  var n = 10;
  for (var x = -n; x < n; ++x) {
    for (var y = -n; y < n; ++y) {
      var actual = simplex.noise2D(x, y);
      var expected = expectedArray[x + n][y + n];

      t.equal(actual, expected);
    }
  }

  t.end();
});

test('noise3D', function(t) {
  var simplex = new SimplexNoise(new alea(2));

  var expectedArray = [ [ [ 0,-0.7600995884773653,0,0,0.7600995884773653,0.7600995884773676,0,0,1.08451738673253e-15,0 ],
 [ -0.652221399176953,0,0,-0.10787818930041222,-0.10787818930040928,0,-0.10787818930041222,0.6522213991769574,0,0 ],
 [ 0.10787818930040982,0,-0.7600995884773653,-0.7600995884773667,0,0,0.652221399176956,0,0,0.7600995884773665 ],
 [ 0,0.652221399176953,0.10787818930041056,0,0.7600995884773653,0.10787818930040961,0,-4.703973835965493e-16,-1.0126560769628168e-15,0 ],
 [ 0,0.6522213991769574,0,0.10787818930041222,1.0126560769628168e-15,0,0.867977777777778,-0.7600995884773666,0,0.7600995884773655 ],
 [ 0.867977777777778,0,0.7600995884773653,0.10787818930040954,0,-5.422586933662629e-16,-0.7600995884773667,0,-0.6522213991769534,-0.6522213991769549 ],
 [ 0,0.8679777777777775,-0.8679777777777772,0,0.760099588477366,0.652221399176956,0,0,1.0306214044052416e-15,0 ],
 [ -0.10787818930041222,-0.6522213991769574,0,-0.7600995884773655,-0.7600995884773678,0,0.8679777777777775,-0.10787818930041039,0,-1.04858673184767e-15 ],
 [ -7.18613097697119e-17,0,0,0.7600995884773666,0,-0.1078781893004126,0.1078781893004113,0,0.760099588477366,0.10787818930041147 ],
 [ 0,0.8679777777777775,-0.10787818930041063,0,5.422586933662626e-16,-0.6522213991769538,0,-0.7600995884773667,0.760099588477367,0 ],
 ],
 [ [ 0.7600995884773653,0.7600995884773672,0,0.652221399176953,-7.18613097697119e-17,0,0.10787818930041222,0.867977777777778,0,0.10787818930041222 ],
 [ 0.8679777777777771,0,0,0,0,0,0.10787818930040921,0,-0.652221399176953,0.7600995884773676 ],
 [ 0,-0.10787818930041222,7.186130976971217e-17,0,0.10787818930041222,-0.10787818930041063,0,-4.703973835965493e-16,-0.10787818930041164,0 ],
 [ 0.7600995884773653,0.7600995884773676,0,-0.10787818930041222,0.7600995884773665,0,5.063280384814059e-16,0.652221399176956,0,0.7600995884773653 ],
 [ 0.7600995884773676,0,0.10787818930041222,-1.0845173867325289e-15,0,-5.063280384814063e-16,-7.186130976971217e-17,0,0.6522213991769534,-1.0126560769628144e-15 ],
 [ 0,-0.7600995884773653,0.652221399176956,0,-0.10787818930041193,9.407947671931047e-16,0,-0.867977777777778,-0.10787818930041074,0 ],
 [ 0,-1.0126560769628182e-15,0,-0.8679777777777775,-0.652221399176956,0,-0.10787818930041193,0.6522213991769539,0,-0.7600995884773664 ],
 [ 0.1078781893004103,0,0.7600995884773659,9.407947671931047e-16,0,-0.10787818930041196,-9.407947671931005e-16,0,-0.10787818930041221,-0.8679777777777784 ],
 [ 0,-0.652221399176953,1.0845173867325289e-15,0,0.10787818930041256,0.10787818930041138,0,0.10787818930041221,-9.407947671931015e-16,0 ],
 [ 0,1.08451738673253e-15,0,0.10787818930041222,0.760099588477366,0,-3.2502532901041623e-16,0.7600995884773661,0,0.652221399176956 ],
 ],
 [ [ -0.10787818930040982,0,-0.7600995884773653,-0.10787818930041063,0,0,1.0845173867325289e-15,0,0,0.7600995884773667 ],
 [ 0,0,7.186130976971217e-17,0,-0.7600995884773653,1.0845173867325289e-15,0,0.7600995884773659,0.652221399176956,0 ],
 [ 0.7600995884773653,-0.10787818930040961,0,-0.8679777777777775,-0.760099588477367,0,-5.422586933662626e-16,0.8679777777777781,0,-0.7600995884773653 ],
 [ 0.8679777777777783,0,0.8679777777777775,-0.8679777777777781,0,0.7600995884773655,-0.10787818930041101,0,0,-0.760099588477367 ],
 [ 0,-0.652221399176953,0.10787818930041101,0,0.6522213991769541,-0.760099588477367,0,5.063280384814063e-16,-0.760099588477367,0 ],
 [ 0.7600995884773653,-7.186130976971217e-17,0,-0.1078781893004126,0.10787818930041101,0,0.6522213991769541,0.10787818930041117,0,0.7600995884773667 ],
 [ -0.7600995884773677,0,-0.6522213991769534,0.8679777777777781,0,-0.760099588477366,-0.10787818930041124,0,-0.8679777777777776,0.8679777777777782 ],
 [ 0,-0.8679777777777775,-0.10787818930041101,0,0.10787818930041193,-2.531640192407038e-16,0,0.8679777777777784,0.10787818930041174,0 ],
 [ 0,-0.7600995884773667,0,0.7600995884773653,-0.10787818930041101,0,-0.7600995884773667,-0.6522213991769557,0,-0.10787818930041101 ],
 [ 9.407947671931047e-16,0,-0.10787818930041222,-0.760099588477367,0,1.7965327442428135e-17,0.7600995884773669,0,-0.8679777777777781,0.652221399176953 ],
 ],
 [ [ 0,0.7600995884773653,-0.6522213991769571,0,0.10787818930041222,0.8679777777777783,0,0.7600995884773655,-0.652221399176956,0 ],
 [ 0,0.6522213991769574,0,-0.7600995884773653,-1.0845173867325289e-15,0,-3.5930654884856634e-17,0.7600995884773677,0,0.652221399176953 ],
 [ -0.10787818930041157,0,-0.8679777777777775,0.10787818930041101,0,-0.1078781893004121,0,0,-0.8679777777777775,0 ],
 [ 0,0.7600995884773653,-0.652221399176956,0,-5.422586933662626e-16,-0.8679777777777781,0,0.7600995884773655,0.10787818930041101,0 ],
 [ 0,-7.186130976971217e-17,0,-0.7600995884773655,0.8679777777777781,0,-0.7600995884773656,0.652221399176956,0,0.10787818930041078 ],
 [ -0.652221399176956,0,-0.7600995884773655,0.10787818930041101,0,3.593065488485658e-17,0.10787818930041099,0,-0.7600995884773667,0.6522213991769553 ],
 [ 0,-0.6522213991769539,-0.760099588477367,0,0.760099588477366,-0.8679777777777774,0,-0.1078781893004117,-5.422586933662639e-16,0 ],
 [ 0.10787818930041256,7.186130976971217e-17,0,5.422586933662626e-16,0.652221399176956,0,-0.8679777777777775,0.7600995884773664,0,0.652221399176956 ],
 [ -1.0126560769628168e-15,0,0,-0.10787818930041101,0,3.344203514933079e-16,0,0,0.760099588477367,0 ],
 [ 0,0,0.760099588477367,0,-0.7600995884773669,-0.7600995884773669,0,0.652221399176956,0.10787818930041222,0 ],
 ],
 [ [ -0.8679777777777775,0.10787818930041022,0,0.10787818930041222,0.7600995884773667,0,-0.7600995884773656,-0.7600995884773676,0,-0.7600995884773655 ],
 [ 0.6522213991769574,0,0,0,0,0.10787818930041196,7.186130976971217e-17,0,0.8679777777777775,-7.186130976971285e-17 ],
 [ 0,0.7600995884773653,0.8679777777777781,0,-0.10787818930041143,0.652221399176956,0,0,0.10787818930041101,0 ],
 [ -0.7600995884773653,7.186130976971217e-17,0,0.1078781893004121,0.760099588477367,0,0.6522213991769541,-0.8679777777777781,0,-5.422586933662639e-16 ],
 [ -7.186130976971217e-17,0,-0.760099588477366,0.760099588477367,0,0.6522213991769543,0.8679777777777777,0,0.7600995884773669,-5.063280384814072e-16 ],
 [ 0,0.10787818930041243,-0.10787818930041101,0,0,1.7965327442428163e-17,0,-2.0783834187295573e-16,-0.7600995884773664,0 ],
 [ -0.6522213991769537,7.186130976971217e-17,0,0.760099588477366,-0.10787818930041117,0,0.10787818930041118,0.7600995884773661,0,-0.652221399176956 ],
 [ 1.0845173867325289e-15,0,-0.10787818930041193,0,0,-1.8987301443052752e-16,0.7600995884773661,0,-0.760099588477367,-0.867977777777778 ],
 [ 0,4.703973835965493e-16,0.760099588477367,0,0.107878189300411,0.7600995884773664,0,0,3.5930654884856634e-17,0 ],
 [ -0.7600995884773655,-0.10787818930041147,0,-5.422586933662639e-16,0.7600995884773664,0,-0.10787818930041101,5.063280384814063e-16,0,0.652221399176956 ],
 ],
 [ [ 0.867977777777777,0,0.8679777777777775,-0.7600995884773677,0,0.6522213991769537,-0.7600995884773667,0,5.063280384814059e-16,-0.7600995884773663 ],
 [ 0,0.652221399176953,0.10787818930041157,0,0.10787818930041196,-0.7600995884773666,0,0.6522213991769537,1.0306214044052416e-15,0 ],
 [ -0.10787818930041222,-1.0126560769628168e-15,0,-0.8679777777777775,0,0,-0.6522213991769537,0.7600995884773667,0,0.7600995884773667 ],
 [ 0.6522213991769571,0,0.7600995884773655,0.8679777777777781,0,0.10787818930041143,2.3519869179827543e-16,0,0.7600995884773667,5.332760296450499e-16 ],
 [ 0,-4.703973835965498e-16,0.760099588477367,0,-0.7600995884773661,-0.1078781893004115,0,0.7600995884773661,3.5930654884856394e-17,0 ],
 [ 0.10787818930041143,-0.7600995884773676,0,-0.10787818930041143,0.7600995884773664,0,6.329100481017584e-17,0.10787818930041157,0,0.760099588477367 ],
 [ -0.7600995884773676,0,-0.10787818930041193,-0.10787818930041092,0,0.10787818930041124,0.8679777777777778,0,0,-0.867977777777778 ],
 [ 0,-0.6522213991769541,2.531640192407038e-16,0,0.7600995884773659,-8.982663721214112e-18,0,-0.10787818930041101,-0.760099588477366,0 ],
 [ 0.6522213991769534,0.7600995884773664,0,-0.7600995884773667,0.6522213991769549,0,0.760099588477367,5.422586933662629e-16,0,0 ],
 [ -0.6522213991769548,0,0.7600995884773665,-0.7600995884773669,0,-0.8679777777777781,0.760099588477366,0,0,0.652221399176953 ],
 ],
 [ [ 0,-0.10787818930041222,0.10787818930041164,0,-0.760099588477366,-9.407947671931047e-16,0,0.7600995884773656,0.7600995884773661,0 ],
 [ 0.652221399176953,0.7600995884773667,0,-0.1078781893004126,-0.652221399176956,0,-0.867977777777778,-0.10787818930041232,0,-0.10787818930041175 ],
 [ 0.7600995884773667,0,-0.6522213991769534,0.652221399176956,0,-0.6522213991769537,0.1078781893004115,0,-2.531640192407038e-16,-0.10787818930041124 ],
 [ 0,0.1078781893004116,0,0,-4.703973835965498e-16,-0.8679777777777776,0,0.7600995884773661,0.7600995884773669,0 ],
 [ 0.7600995884773656,7.186130976971217e-17,0,0.6522213991769541,0.7600995884773667,0,0.7600995884773659,0,0,0 ],
 [ -0.8679777777777772,0,-0.10787818930041143,0.7600995884773661,0,-0.1078781893004113,-0.10787818930041167,0,0,-5.063280384814063e-16 ],
 [ 0,-5.422586933662629e-16,0.10787818930041117,0,-0.7600995884773659,-0.8679777777777778,0,0,0.10787818930041193,0 ],
 [ -0.6522213991769541,-0.10787818930041086,0,-0.10787818930041114,-0.7600995884773661,0,0,-0.867977777777778,0,0.652221399176956 ],
 [ 0.760099588477366,0,2.711293466831319e-16,0.10787818930041174,0,-0.10787818930041101,-0.10787818930041193,0,0,-0.652221399176953 ],
 [ 0,0.6522213991769548,-0.10787818930041128,0,0.760099588477367,-0.10787818930041196,0,-0.652221399176956,-0.10787818930041222,0 ],
 ],
 [ [ -0.652221399176953,0.867977777777778,0,-0.7600995884773655,0.7600995884773678,0,0.10787818930041146,-7.186130976971285e-17,0,0.7600995884773667 ],
 [ -0.10787818930040921,0,-4.703973835965493e-16,0.7600995884773665,0,-5.422586933662629e-16,0.7600995884773664,0,-0.8679777777777777,0.10787818930041264 ],
 [ 0,-0.7600995884773655,0,0,-0.10787818930041196,1.7965327442428135e-17,0,0.10787818930041204,-0.6522213991769557,0 ],
 [ 5.063280384814059e-16,-0.7600995884773678,0,0.7600995884773655,0,0,0.7600995884773661,0.10787818930041204,0,-0.652221399176956 ],
 [ -0.8679777777777783,0,0.760099588477366,0,0,0.1078781893004114,0.7600995884773661,0,0,0 ],
 [ 0,-0.10787818930041196,0.10787818930041118,0,1.7965327442428225e-17,0.7600995884773661,0,0,-3.593065488485658e-17,0 ],
 [ 0,-8.133880400493948e-16,0,-2.8909467412556e-16,-0.6522213991769543,0,-0.10787818930041101,0.6522213991769543,0,0.10787818930041101 ],
 [ 0.8679777777777783,0,0.7600995884773669,0.867977777777778,0,-0.10787818930041101,-0.7600995884773661,0,0.760099588477367,0 ],
 [ 0,-0.10787818930041222,0,0,-0.8679777777777781,0.10787818930041193,0,-0.760099588477367,0,0 ],
 [ 0.7600995884773655,-0.7600995884773667,0,0,4.703973835965498e-16,0,-0.10787818930041101,0.7600995884773653,0,-0.8679777777777781 ],
 ],
 [ [ -0.7600995884773676,0,-0.10787818930041222,0.8679777777777783,0,-0.7600995884773655,-0.10787818930041233,0,9.407947671931015e-16,0.10787818930041056 ],
 [ 0,0.8679777777777775,0.7600995884773676,0,-0.6522213991769534,-8.133880400493948e-16,0,0.10787818930041226,0.10787818930041056,0 ],
 [ -0.7600995884773653,-0.10787818930041164,0,-0.7600995884773653,0.10787818930041101,0,-0.7600995884773667,0,0,0 ],
 [ 1.0845173867325289e-15,0,-0.10787818930041222,0.10787818930041101,0,-3.1645502405087976e-16,0.7600995884773669,0,0,0.10787818930041222 ],
 [ 0,-0.8679777777777775,0,0,0.107878189300411,-3.5930654884856394e-17,0,0.10787818930041101,-0.7600995884773659,0 ],
 [ -0.7600995884773655,0.10787818930041056,0,0,-0.7600995884773664,0,-0.8679777777777781,0.7600995884773656,0,0 ],
 [ -0.6522213991769545,0,-2.3519869179827563e-16,-0.8679777777777782,0,0,-0.867977777777778,0,0,0 ],
 [ 0,-5.422586933662632e-16,0.6522213991769552,0,0.652221399176956,0.7600995884773656,0,-0.760099588477367,0.7600995884773653,0 ],
 [ -0.760099588477367,-1.0845173867325273e-15,0,0,4.703973835965493e-16,0,0.760099588477367,-0.8679777777777775,0,0 ],
 [ 0.6522213991769555,0,-0.652221399176956,0.10787818930041222,0,0.10787818930041101,0.7600995884773653,0,0,0.10787818930041222 ],
 ],
 [ [ 0,0.8679777777777775,1.0845173867325289e-15,0,3.5930654884856634e-17,-0.7600995884773655,0,0.10787818930041226,0.6522213991769554,0 ],
 [ 0.10787818930041222,-0.10787818930041022,0,0.652221399176953,1.0126560769628144e-15,0,-0.7600995884773664,5.422586933662632e-16,0,0.10787818930040961 ],
 [ 0.10787818930041164,0,-0.8679777777777775,0,0,0.10787818930041111,0.8679777777777782,0,0.652221399176956,0 ],
 [ 0,-0.10787818930041222,0,0,-5.422586933662639e-16,-0.7600995884773669,0,0,-0.10787818930041222,0 ],
 [ -0.867977777777778,-0.7600995884773669,0,0.6522213991769557,-0.8679777777777778,0,0.10787818930041101,-3.593065488485658e-17,0,-0.652221399176956 ],
 [ 0.1078781893004108,0,0.7600995884773667,0.7600995884773665,0,0.652221399176956,0.10787818930041243,0,-0.760099588477367,-0.652221399176953 ],
 [ 0,0.867977777777778,0.7600995884773665,0,0.760099588477367,0.10787818930041193,0,0.652221399176956,0,0 ],
 [ 0.10787818930041129,-5.422586933662632e-16,0,-0.652221399176956,0,0,-0.760099588477367,0.652221399176953,0,0.760099588477367 ],
 [ 0.7600995884773659,0,-0.760099588477367,0.8679777777777775,0,0,0.7600995884773653,0,0,-0.10787818930041222 ],
 [ 0,-0.6522213991769571,-0.652221399176953,0,0,0.652221399176953,0,0,-0.7600995884773653,0 ],
 ]];

  var n = 5;
  for (var x = -n; x < n; ++x) {
    for (var y = -n; y < n; ++y) {
      for (var z = -n; z < n; ++z) {
        var actual = simplex.noise3D(x, y, z);
        var expected = expectedArray[x + n][y + n][z + n];

        t.equals(actual, expected);
      }
    }
  }
  t.end();
});

test('noise4D', function(t) {
  var simplex = new SimplexNoise(new alea(2));

  var expectedArray = [ [ [ [ 0.26863956928859867, -0.6528107795552647, -0.4052579578861305, -0.7875866299752421, 0.20639204349957746, -0.22094685125260707 ],
 [ 0.7889277122928673, -0.13508598596204352, 0.7875866299752421, -0.30910956517605637, 0.2209970755584349, 0.20347658649113445 ],
 [ 0.13508598596204352, 0.2615450624752103, -0.05135876083823943, -0.2208966269467793, 0.20347808144150664, -0.08226691676278018 ],
 [ 0.2615450624752103, 0.05135876083823943, 0.2209970755584349, -0.20347658649113387, -0.30908338608486813, -0.8224875632128805 ],
 [ 0.05135876083823943, -0.2208966269467793, 0.20347509154076182, 0.30908338608486763, -0.2741625210709602, 0.11095152519660674 ],
 [ 0.22094685125260707, -0.20347808144150514, 0.08226691676278039, -0.81669302521044, 0.11095152519660674, -0.41983437977638477 ],
 ],
 [ [ 0.7889277122928673, -0.4052579578861305, -0.25859361992559904, -0.20639204349957746, 0.2208966269467793, 0.6104297594734006 ],
 [ -0.13508598596204352, 0.7875866299752421, -0.927328695528169, -0.22094685125260707, 0.20347658649113373, 0.08226691676278039 ],
 [ 0.26449650502482147, 0.30910956517605637, 0.2208966269467793, -0.2034765864911325, 0.30908338608486796, -0.2741625210709602 ],
 [ -0.30910956517605637, -0.22094685125260707, -0.20347808144150456, 0.3090833860848674, 0.8108984872079994, 0.11095152519660711 ],
 [ 0.6626898808403379, -0.20347658649113307, -0.1445495525593075, 0.26836798306851967, -0.11095152519660749, -0.19551707645726524 ],
 [ 0.20347808144150514, -0.08226691676278039, 0.26836798306851967, -0.11095152519660674, -0.8108685326909153, -0.8979690292516493 ],
 ],
 [ [ 0.13508598596204352, 0.26744794757443274, 0.05135876083823943, 0.6626898808403379, 0.20347808144150595, 0.3090833860848674 ],
 [ 0.7875866299752421, 0.4118270868525352, -0.2208966269467793, -0.6104342443245172, 0.08226691676277997, -0.81669302521044 ],
 [ 0.30910956517605637, 0.6627401051461657, 0.6104327493741448, -0.2468007502883394, 0.8051039492055588, -0.3328545755898213 ],
 [ -0.2208966269467793, -0.20347509154076251, -0.2468007502883394, 0.26836798306851967, -0.33285457558982057, 0.307675728116825 ],
 [ -0.20347808144150525, 0.08226691676277985, -0.26257344506607916, -0.33285457558982057, 0.307675728116825, 0.29932300975054976 ],
 [ -0.08226691676277964, -0.26836798306851967, -0.11095152519660711, 0.19551707645726524, 0.26161158647062344, 0 ],
 ],
 [ [ 0.7934895150744645, 0.20639204349957746, -0.2209970755584349, 0.20347658649113456, 0.08226691676277997, 0.81669302521044 ],
 [ -0.30910956517605637, -0.2208966269467793, -0.20347658649113387, 0.30908338608486763, 0.26836798306851967, 0.3328545755898213 ],
 [ -0.2208966269467793, 0.20347808144150595, -0.3090833860848674, -0.26836798306851967, -0.11095152519660749, -0.19551707645726524 ],
 [ 0.6104342443245164, -0.1445495525593075, 0.8108984872079994, -0.33285457558982057, 0.19551707645726524, -0.8225461826917968 ],
 [ -0.5358998554069551, -0.2741625210709602, 0.33285457558982057, -0.19551707645726524, 0.33703443303047603, 0 ],
 [ -0.81669302521044, -0.11095152519660711, 0.5865512293717957, -0.33703443303047603, 0, -0.8225461826917961 ],
 ],
 [ [ 0.30910956517605637, 0.22094685125260707, -0.20347808144150525, -0.08226691676278007, 0.8108984872079994, -0.11095152519660674 ],
 [ 0.2208966269467793, -0.20347808144150514, 0.08226691676278028, -0.2741625210709602, -0.33285457558982096, 0.307675728116825 ],
 [ 0.2034795763918787, -0.24680075028833964, 0.8224875632128805, 0.33285457558982096, -0.19551707645726524, 0.26161158647062344 ],
 [ 0.30908338608486774, 0.8108984872079994, -0.11095152519660711, 0.19551707645726524, -0.29932300975054976, 0 ],
 [ -0.26836798306851967, -0.11095152519660637, 0.307675728116825, -0.29932300975054976, 0, 0.26161158647062377 ],
 [ -0.11095152519660674, 0.307675728116825, 0.26161158647062344, 0, 0.26161158647062377, -0.4198343797763849 ],
 ],
 [ [ -0.22094685125260707, 0.20347808144150514, 0.08226691676277985, -0.8108984872079994, -0.11095152519660674, -0.307675728116825 ],
 [ 0.20347509154076102, -0.5358998554069547, -0.81669302521044, -0.11095152519660674, 0.08335842479770547, -0.2239001631906972 ],
 [ -0.08226691676277943, 0.2741625210709602, -0.11095152519660711, 0.19551707645726524, 0.8602576059717231, 0 ],
 [ 0.26836798306851967, 0.11095152519660711, -0.19551707645726524, 0.29932300975054976, 0, 0.8602576059717225 ],
 [ 0.11095152519660674, 0.307675728116825, -0.8225461826917968, 0, 0.29932300975054943, -0.8108685326909153 ],
 [ 0.19551707645726524, -0.7848347594118704, 0, 0.2616115864706234, 0.0833584247977059, 0.11095152519660606 ],
 ],
 ],
 [ [ [ -0.4444651477477593, -0.13508598596204352, -0.26449650502482147, 0.927328695528169, 0.2208966269467793, 0.6104312544237727 ],
 [ -0.13508598596204352, -0.2615450624752103, -0.15407628251471833, 0.22094685125260707, 0.20347509154076102, 0.7004336889325155 ],
 [ -0.26744794757443274, 0.05135876083823943, 0.6627401051461657, -0.20347808144150525, 0.144549552559308, -0.26836798306851967 ],
 [ 0.30910956517605637, 0.22084640264095148, 0.6104327493741444, -0.5358998554069553, -0.8108984872079994, 0.33285457558982096 ],
 [ -0.22094685125260707, -0.20347808144150514, -0.7004336889325153, 0.8108984872079994, 0.11095152519660637, -0.08335842479770547 ],
 [ -0.20347957639187855, 0.08226691676278039, -0.8108984872079994, 0.11095152519660749, -0.5865512293717957, -0.8979690292516493 ],
 ],
 [ [ -0.13508598596204352, 0.26744794757443274, 0.05135876083823943, 0.6626898808403379, -0.20347658649113373, 0.14454955255930718 ],
 [ 0.25859361992559904, -0.4118270868525352, 0.2208966269467793, 0.6104327493741447, -0.14454955255930738, 0.26836798306851967 ],
 [ 0.927328695528169, -0.22084640264095148, -0.20347808144150525, 0.3090833860848674, -0.81669302521044, -0.3328545755898213 ],
 [ 0.6627401051461657, -0.20347808144150514, 0.5358998554069553, -0.2741625210709602, 0.33285457558982057, 0.19551707645726524 ],
 [ 0.20347658649113307, 0.30908338608486796, -0.26836798306851967, 0.33285457558982096, -0.5865512293717957, 0.8225461826917968 ],
 [ 0.14454955255930718, 0.2799570590734007, -0.3328545755898213, -0.19551707645726524, -0.26161158647062344, 0 ],
 ],
 [ [ 0.2615450624752103, -0.4118270868525352, 0.2208966269467793, 0.610431254423773, -0.5358998554069551, 0.26836798306851967 ],
 [ -0.05135876083823943, -0.6627401051461657, -0.6104327493741444, 0.7004336889325148, -0.26836798306851967, 0.11095152519660711 ],
 [ -0.2208966269467793, -0.20347509154076182, -0.30908338608486763, 0.26836798306851967, 0.11095152519660711, 0.307675728116825 ],
 [ 0.6104297594734003, -0.3090833860848674, -0.8108984872079994, 0.11095152519660711, -0.5865512293717957, 0.26161158647062344 ],
 [ 0.3090833860848673, -0.26836798306851967, -0.11095152519660674, 0.307675728116825, -0.29932300975054976, 0 ],
 [ 0.2741625210709602, 0.11095152519660711, -0.307675728116825, 0.29932300975054976, 0, 0.2616115864706234 ],
 ],
 [ [ 0.20639204349957746, 0.6627903294519936, 0.203479576391878, -0.24680075028833992, 0.2741625210709602, 0.33285457558982096 ],
 [ -0.2209970755584349, -0.20347808144150514, 0.1445495525593075, 0.26836798306851967, -0.11095152519660674, 0.41983437977638477 ],
 [ 0.203479576391878, -0.1445495525593079, 0.81669302521044, -0.11095152519660637, -0.08335842479770547, 0.29932300975054976 ],
 [ -0.08226691676277964, -0.2741625210709602, -0.11095152519660674, -0.307675728116825, -0.2239001631906972, 0 ],
 [ 0.8224875632128805, 0.11095152519660674, -0.8108685326909153, -0.8602576059717231, 0, 0.33703443303047587 ],
 [ -0.11095152519660674, -0.19551707645726524, 0.26161158647062344, 0, -0.26161158647062377, 0.9230271843504753 ],
 ],
 [ [ 0.22094685125260707, -0.2034780814415058, -0.3090833860848675, 0.8108984872079994, -0.11095152519660674, -0.307675728116825 ],
 [ -0.6104312544237727, -0.47361721961042763, 0.26836798306851967, -0.11095152519660749, -0.08335842479770547, -0.29932300975054976 ],
 [ 0.08226691676277977, -0.2741625210709602, 0.11095152519660674, -0.19551707645726524, -0.8602576059717231, 0 ],
 [ 0.26257344506607916, 0.11095152519660637, -0.307675728116825, 0.26161158647062344, 0, 0.8602576059717225 ],
 [ -0.11095152519660711, -0.5865512293717957, 0.26161158647062344, 0, 0.26161158647062327, -0.3076757281168252 ],
 [ -0.9230271843504749, -0.8225461826917968, 0, -0.3370344330304754, -0.19551707645726493, -0.3328545755898197 ],
 ],
 [ [ 0.6104327493741454, 0.08226691676278018, 0.26836798306851967, -0.11095152519660749, -0.19551707645726524, -0.29932300975054976 ],
 [ -0.08226691676277997, 0.2741625210709602, -0.11095152519660711, -0.08335842479770547, -0.29932300975054976, 0 ],
 [ -0.26836798306851967, -0.11095152519660711, 0.307675728116825, -0.29932300975054976, 0, -0.8602576059717222 ],
 [ 0.11095152519660711, 0.6987098810313555, 0.8602576059717231, 0, -0.26161158647062316, -0.5865512293717959 ],
 [ -0.41983437977638477, -0.8979690292516493, 0, 0.8979690292516486, 0.6987098810313557, 0.3328545755898197 ],
 [ -0.33703443303047603, 0, 0.2616115864706234, -0.19551707645726518, -0.11095152519660606, 0.810898487208001 ],
 ],
 ],
 [ [ [ 0.13508598596204352, 0.25859361992559904, 0.05135876083823943, -0.6628405537578214, -0.20347658649113387, 0.14454955255930782 ],
 [ 0.26744794757443274, -0.05135876083823943, 0.6627401051461657, 0.20347808144150525, 0.08226691676277997, -0.2741625210709602 ],
 [ -0.20639204349957746, 0.22094685125260707, 0.203476586491134, -0.08226691676277981, -0.2741625210709602, -0.11095152519660711 ],
 [ -0.22094685125260707, -0.20347658649113387, -0.5358998554069555, -0.2741625210709602, -0.33285457558982057, -0.5865512293717957 ],
 [ 0.20347658649113456, -0.08226691676277997, -0.2799570590734007, 0.11095152519660749, 0.307675728116825, 0.26161158647062344 ],
 [ 0.08226691676278018, -0.2741625210709602, 0.11095152519660711, -0.5865512293717957, -0.7848347594118704, 0 ],
 ],
 [ [ 0.2615450624752103, -0.4118270868525352, 0.2208966269467793, 0.6104327493741452, -0.30908338608486774, -0.2741625210709602 ],
 [ 0.05135876083823943, 0.6627903294519936, -0.20347509154076113, -0.7004336889325151, -0.2741625210709602, 0.11095152519660711 ],
 [ 0.22094685125260707, 0.6104297594734003, -0.0822669167627797, -0.26257344506607916, 0.33285457558982096, 0.08335842479770547 ],
 [ 0.20347658649113318, -0.08226691676278028, -0.26836798306851967, 0.11095152519660637, 0.5865512293717957, -0.33703443303047603 ],
 [ -0.08226691676277964, -0.2741625210709602, -0.11095152519660674, 0.8108685326909153, -0.8979690292516493, 0 ],
 [ 0.81669302521044, 0.3328545755898213, -0.8108685326909153, 0.2239001631906972, 0, -0.33703443303047537 ],
 ],
 [ [ 0.20639204349957746, -0.2208966269467793, 0.6104312544237728, 0.0822669167627799, -0.26257344506607916, 0.11095152519660711 ],
 [ 0.6627903294519936, 0.2034765864911325, 0.47361721961042696, 0.81669302521044, -0.11095152519660711, 0.307675728116825 ],
 [ 0.2034780814415061, -0.7004336889325149, 0.2741625210709602, -0.3328545755898213, -0.41983437977638477, 0.33703443303047603 ],
 [ -0.47361721961042685, 0.2741625210709602, -0.11095152519660711, -0.307675728116825, -0.7848347594118704, 0 ],
 [ 0.8108984872079994, -0.11095152519660711, -0.6987098810313555, 0.26161158647062344, 0, 0.29932300975054965 ],
 [ 0.11095152519660711, -0.307675728116825, 0.29932300975054976, 0, 0.8602576059717225, 0.1955170764572653 ],
 ],
 [ [ 0.6626898808403379, -0.6104327493741452, -0.0822669167627797, -0.2799570590734007, -0.11095152519660749, -0.8108685326909153 ],
 [ -0.6104297594734003, -0.7004336889325149, 0.8108984872079994, -0.11095152519660637, 0.19551707645726524, -0.8602576059717231 ],
 [ -0.30908338608486774, -0.8108984872079994, 0.11095152519660711, -0.9230271843504749, 0.26161158647062344, 0 ],
 [ -0.2741625210709602, 0.11095152519660674, 0.307675728116825, -0.29932300975054976, 0, 0.29932300975054943 ],
 [ -0.11095152519660711, 0.9230271843504749, 0.26161158647062344, 0, -0.8979690292516491, -0.19551707645726527 ],
 [ 0.9230271843504749, 0.8225461826917968, 0, 0.33703443303047564, 0.19551707645726524, 0.11095152519660674 ],
 ],
 [ [ -0.610429759473401, -0.47361721961042746, 0.81669302521044, -0.11095152519660674, -0.8108685326909153, 0.26161158647062344 ],
 [ 0.5358998554069556, 0.26257344506607916, -0.3328545755898213, 0.41983437977638477, 0.2239001631906972, 0 ],
 [ -0.8108984872079994, -0.11095152519660674, 0.8108685326909153, -0.8225461826917968, 0, 0.8602576059717225 ],
 [ -0.11095152519660749, 0.08335842479770547, 0.8225461826917968, 0, -0.8225461826917968, 0.8108685326909151 ],
 [ -0.19551707645726524, -0.8225461826917968, 0, -0.2616115864706232, 0.30767572811682486, 0.11095152519660674 ],
 [ -0.8602576059717231, 0, -0.8602576059717223, 0.6987098810313555, 0.3328545755898202, 0.26836798306851994 ],
 ],
 [ [ -0.3090833860848678, 0.2799570590734007, 0.11095152519660711, 0.8108685326909153, 0.2239001631906972, 0 ],
 [ 0.26836798306851967, 0.11095152519660711, -0.307675728116825, 0.29932300975054976, 0, -0.8602576059717222 ],
 [ -0.11095152519660711, -0.19551707645726524, -0.29932300975054976, 0, 0.7848347594118702, -0.08335842479770574 ],
 [ 0.41983437977638477, 0.8602576059717231, 0, 0.22390016319069755, -0.8108685326909151, 0.11095152519660674 ],
 [ -0.8225461826917968, 0, 0.2616115864706236, 0.8108685326909151, 0.11095152519660674, 0.27416252107096045 ],
 [ 0, 0.29932300975054943, 0.9230271843504745, -0.11095152519660674, -0.8166930252104408, 0.3090833860848678 ],
 ],
 ],
 [ [ [ -0.2615450624752103, -0.4118270868525352, -0.2208966269467793, 0.6104297594734003, -0.5358998554069555, -0.26836798306851967 ],
 [ 0.4118270868525352, 0.22094685125260707, 0.20347808144150525, -0.5358998554069555, -0.8108984872079994, 0.33285457558982096 ],
 [ 0.2208966269467793, -0.6104312544237722, 0.3090833860848681, -0.2799570590734007, -0.11095152519660674, 0.08335842479770547 ],
 [ 0.6104297594734003, -0.30908338608486763, -0.81669302521044, 0.33285457558982057, -0.307675728116825, -0.26161158647062344 ],
 [ -0.7004336889325151, -0.2741625210709602, 0.11095152519660711, -0.41983437977638477, -0.33703443303047603, 0 ],
 [ 0.26836798306851967, -0.11095152519660674, -0.19551707645726524, -0.26161158647062344, 0, 0.2616115864706232 ],
 ],
 [ [ 0.05135876083823943, 0.22094685125260707, -0.6104327493741444, -0.08226691676277977, 0.81669302521044, -0.11095152519660749 ],
 [ -0.6627903294519936, 0.6104327493741454, 0.3090833860848674, -0.8051039492055588, -0.11095152519660674, -0.5865512293717957 ],
 [ -0.6104312544237722, 0.08226691676277956, 0.26836798306851967, -0.33285457558982057, -0.8108685326909153, 0.7848347594118704 ],
 [ -0.24680075028833964, -0.8108984872079994, -0.33285457558982096, 0.307675728116825, 0.29932300975054976, 0 ],
 [ -0.26836798306851967, -0.11095152519660637, 0.307675728116825, 0.2239001631906972, 0, -0.26161158647062316 ],
 [ -0.11095152519660749, 0.08335842479770547, -0.29932300975054976, 0, -0.26161158647062355, -0.1955170764572652 ],
 ],
 [ [ -0.22094685125260707, 0.2034765864911325, -0.14454955255930801, -0.26836798306851967, 0.11095152519660674, 0.41983437977638477 ],
 [ -0.20347509154076251, -0.14454955255930815, 0.8051039492055588, -0.11095152519660711, 0.19551707645726524, -0.8225461826917968 ],
 [ 0.08226691676278, 0.26257344506607916, 0.11095152519660674, -0.6987098810313555, 0.8602576059717231, 0 ],
 [ 0.2741625210709602, 0.33285457558982096, -0.19551707645726524, -0.29932300975054976, 0, -0.22390016319069753 ],
 [ 0.11095152519660711, -0.08335842479770547, 0.29932300975054976, 0, -0.2993230097505495, 0.30767572811682486 ],
 [ 0.307675728116825, 0.26161158647062344, 0, -0.2993230097505497, 0.1955170764572653, 0.11095152519660674 ],
 ],
 [ [ 0.20347808144150525, 0.7004336889325147, 0.26836798306851967, 0.11095152519660711, -0.41983437977638477, -0.8225461826917968 ],
 [ 0.7004336889325149, 0.2741625210709602, -0.11095152519660711, -0.307675728116825, 0.2239001631906972, 0 ],
 [ 0.8108984872079994, -0.33285457558982057, -0.8108685326909153, 0.33703443303047603, 0, 0.2616115864706237 ],
 [ -0.11095152519660674, 0.41983437977638477, -0.29932300975054976, 0, -0.8602576059717228, 0.30767572811682486 ],
 [ 0.307675728116825, -0.8602576059717231, 0, -0.33703443303047603, -0.4198343797763845, -0.11095152519660674 ],
 [ -0.7848347594118704, 0, -0.2993230097505493, -0.30767572811682486, -0.11095152519660674, -0.8166930252104408 ],
 ],
 [ [ -0.5358998554069556, 0.2741625210709602, 0.33285457558982096, -0.6987098810313555, 0.2239001631906972, 0 ],
 [ 0.8224875632128805, 0.11095152519660637, -0.5865512293717957, 0.8602576059717231, 0, -0.2616115864706235 ],
 [ -0.33285457558982057, 0.307675728116825, -0.8979690292516493, 0, 0.26161158647062377, 0.1955170764572653 ],
 [ 0.8108685326909153, -0.29932300975054976, 0, 0.3370344330304761, -0.30767572811682486, 0.3328545755898202 ],
 [ -0.29932300975054976, 0, 0.8225461826917968, -0.30767572811682486, 0.11095152519660674, -0.27995705907340107 ],
 [ 0, 0.2239001631906971, -0.30767572811682486, 0.11095152519660674, 0.8108984872080003, -0.3090833860848678 ],
 ],
 [ [ -0.8051039492055588, 0.11095152519660674, 0.5865512293717957, 0.33703443303047603, 0, 0.8602576059717223 ],
 [ 0.11095152519660711, 0.307675728116825, 0.8602576059717231, 0, 0.29932300975054943, 0.3076757281168252 ],
 [ 0.41983437977638477, 0.29932300975054976, 0, 0.8225461826917962, 0.1955170764572653, 0.11095152519660674 ],
 [ -0.8225461826917968, 0, -0.8979690292516489, 0.6987098810313555, -0.3328545755898202, -0.27995705907340107 ],
 [ 0, 0.29932300975054943, -0.30767572811682486, 0.11095152519660674, -0.8108984872080003, 0.4736172196104263 ],
 [ 0.29932300975054943, 0.810868532690915, -0.11095152519660674, -0.8108984872080003, 0.3090833860848678, -0.20347808144150525 ],
 ],
 ],
 [ [ [ -0.15407628251471833, -0.22084640264095148, -0.6104327493741452, 0.30908338608486763, -0.26257344506607916, 0.11095152519660674 ],
 [ 0.2208966269467793, 0.20347957639187786, -0.3090833860848675, -0.26836798306851967, -0.33285457558982096, -0.307675728116825 ],
 [ 0.20347808144150595, 0.30908338608486774, 0.26257344506607916, -0.11095152519660637, 0.6987098810313555, -0.29932300975054976 ],
 [ 0.3090833860848672, 0.2741625210709602, -0.11095152519660674, -0.8108685326909153, -0.8225461826917968, 0 ],
 [ 0.2799570590734007, -0.33285457558982096, -0.08335842479770547, 0.8979690292516493, 0, 0.2993230097505497 ],
 [ -0.33285457558982096, -0.19551707645726524, -0.8979690292516493, 0, 0.22390016319069742, -0.6987098810313557 ],
 ],
 [ [ 0.22094685125260707, -0.20347808144150514, -0.5358998554069554, 0.8108984872079994, 0.11095152519660711, 0.19551707645726524 ],
 [ -0.6104312544237733, -0.7004336889325153, 0.2741625210709602, -0.33285457558982057, -0.5865512293717957, 0.2239001631906972 ],
 [ 0.7004336889325151, -0.2741625210709602, -0.11095152519660749, 0.19551707645726524, 0.29932300975054976, 0 ],
 [ -0.26836798306851967, -0.11095152519660674, 0.307675728116825, 0.29932300975054976, 0, 0.26161158647062355 ],
 [ 0.11095152519660749, -0.19551707645726524, 0.29932300975054976, 0, 0.2993230097505495, -0.3076757281168246 ],
 [ -0.41983437977638477, -0.2239001631906972, 0, -0.22390016319069742, -0.08335842479770585, -0.11095152519660606 ],
 ],
 [ [ 0.203479576391878, -0.08226691676278025, 0.8224875632128805, -0.11095152519660674, 0.41983437977638477, -0.26161158647062344 ],
 [ 0.700433688932515, 0.2741625210709602, -0.11095152519660749, -0.8108685326909153, -0.29932300975054976, 0 ],
 [ 0.2741625210709602, 0.33285457558982096, -0.08335842479770547, 0.26161158647062344, 0, 0.8602576059717225 ],
 [ 0.11095152519660711, 0.19551707645726524, -0.26161158647062344, 0, 0.33703443303047576, -0.1955170764572653 ],
 [ 0.8108685326909153, -0.26161158647062344, 0, 0.8602576059717227, -0.6987098810313555, -0.11095152519660674 ],
 [ -0.8225461826917968, 0, 0.2993230097505492, -0.30767572811682486, -0.11095152519660674, 0.26836798306851994 ],
 ],
 [ [ 0.08226691676277995, 0.2741625210709602, 0.11095152519660637, -0.19551707645726524, 0.8979690292516493, 0 ],
 [ 0.26257344506607916, -0.11095152519660711, -0.307675728116825, -0.2239001631906972, 0, 0.26161158647062327 ],
 [ 0.33285457558982096, 0.307675728116825, -0.7848347594118704, 0, -0.2616115864706234, -0.5865512293717958 ],
 [ -0.41983437977638477, -0.7848347594118704, 0, 0.8979690292516491, 0.19551707645726524, 0.11095152519660674 ],
 [ -0.29932300975054976, 0, -0.26161158647062327, 0.30767572811682486, -0.11095152519660674, -0.8108984872080003 ],
 [ 0, -0.33703443303047587, -0.30767572811682486, 0.11095152519660674, -0.27416252107096045, -0.5358998554069563 ],
 ],
 [ [ 0.8051039492055588, -0.11095152519660749, -0.9230271843504749, 0.2239001631906972, 0, -0.29932300975054943 ],
 [ -0.11095152519660711, -0.307675728116825, -0.8602576059717231, 0, 0.2616115864706235, -0.19551707645726488 ],
 [ 0.8108685326909153, 0.33703443303047603, 0, 0.26161158647062377, 0.1955170764572653, 0.3328545755898202 ],
 [ -0.8225461826917968, 0, 0.8602576059717228, -0.6987098810313555, 0.3328545755898202, -0.27416252107096045 ],
 [ 0, 0.3370344330304757, -0.1955170764572653, 0.11095152519660674, 0.2625734450660794, -0.14454955255930926 ],
 [ -0.2993230097505497, -0.30767572811682486, 0.3328545755898202, 0.27416252107096045, -0.14454955255930926, 0.6104297594733996 ],
 ],
 [ [ -0.11095152519660674, -0.41983437977638477, 0.26161158647062344, 0, 0.8225461826917967, -0.1955170764572655 ],
 [ 0.19551707645726524, -0.2239001631906972, 0, -0.8225461826917962, -0.5865512293717959, -0.11095152519660681 ],
 [ 0.29932300975054976, 0, 0.3370344330304755, 0.19551707645726527, 0.11095152519660674, 0.27995705907340107 ],
 [ 0, -0.8602576059717225, -0.9230271843504745, -0.3328545755898202, -0.8108984872080003, -0.08226691676277925 ],
 [ 0.29932300975054943, -0.19551707645726515, 0.3328545755898202, -0.2625734450660794, -0.5358998554069563, -0.20347658649113318 ],
 [ 0.08335842479770547, 0.3328545755898197, 0.27995705907340107, 0.08226691676277925, -0.20347658649113318, 0.22089662694677964 ],
 ],
 ],
 [ [ [ 0.2208966269467793, 0.2034750915407624, -0.7004336889325153, -0.26836798306851967, -0.11095152519660674, -0.307675728116825 ],
 [ 0.20347658649113445, 0.08226691676278007, -0.26836798306851967, -0.11095152519660674, -0.307675728116825, -0.26161158647062344 ],
 [ -0.3090833860848673, -0.2741625210709602, 0.11095152519660711, 0.307675728116825, -0.26161158647062344, 0 ],
 [ 0.26836798306851967, -0.11095152519660674, -0.307675728116825, -0.8602576059717231, 0, 0.8225461826917961 ],
 [ -0.33285457558982096, -0.6987098810313555, 0.2239001631906972, 0, -0.8979690292516489, 0.41983437977638455 ],
 [ 0.8108685326909153, 0.29932300975054976, 0, 0.8602576059717225, -0.19551707645726554, -0.11095152519660606 ],
 ],
 [ [ -0.6104327493741447, 0.30908338608486746, -0.2799570590734007, 0.11095152519660749, 0.41983437977638477, 0.33703443303047603 ],
 [ 0.08226691676278028, 0.2741625210709602, 0.11095152519660711, 0.19551707645726524, -0.2239001631906972, 0 ],
 [ -0.26257344506607916, 0.11095152519660711, 0.307675728116825, -0.8979690292516493, 0, 0.33703443303047537 ],
 [ 0.11095152519660674, 0.08335842479770547, -0.26161158647062344, 0, -0.26161158647062316, -0.4198343797763849 ],
 [ -0.9230271843504749, 0.26161158647062344, 0, 0.7848347594118704, -0.19551707645726493, 0.11095152519660606 ],
 [ 0.7848347594118704, 0, 0.8979690292516481, -0.1955170764572655, -0.3328545755898197, 0.2741625210709605 ],
 ],
 [ [ -0.5358998554069548, 0.26836798306851967, 0.3328545755898213, 0.5865512293717957, -0.8602576059717231, 0 ],
 [ -0.81669302521044, 0.3328545755898213, 0.6987098810313555, 0.8979690292516493, 0, -0.8979690292516481 ],
 [ 0.11095152519660711, 0.19551707645726524, 0.8602576059717231, 0, -0.2993230097505492, 0.30767572811682486 ],
 [ -0.19551707645726524, 0.29932300975054976, 0, 0.2616115864706237, -0.1955170764572653, 0.3328545755898202 ],
 [ 0.7848347594118704, 0, -0.22390016319069747, -0.9230271843504747, -0.11095152519660674, -0.27416252107096045 ],
 [ 0, 0.8602576059717222, -0.1955170764572653, 0.11095152519660674, -0.26836798306851994, -0.3090833860848678 ],
 ],
 [ [ -0.81669302521044, 0.11095152519660749, 0.8108685326909153, -0.26161158647062344, 0, -0.2993230097505496 ],
 [ 0.11095152519660674, 0.19551707645726524, 0.29932300975054976, 0, -0.3370344330304758, 0.307675728116825 ],
 [ 0.19551707645726524, -0.29932300975054976, 0, 0.2616115864706235, 0.6987098810313555, 0.3328545755898202 ],
 [ 0.8602576059717231, 0, 0.2616115864706233, 0.0833584247977054, 0.11095152519660674, 0.8166930252104408 ],
 [ 0, 0.29932300975054943, -0.08335842479770564, -0.11095152519660674, 0.27416252107096045, 0.3090833860848678 ],
 [ 0.2616115864706232, 0.08335842479770493, 0.11095152519660674, -0.8166930252104408, -0.3090833860848678, 0.20347658649113318 ],
 ],
 [ [ 0.11095152519660674, 0.19551707645726524, 0.29932300975054976, 0, -0.29932300975054926, -0.8108685326909153 ],
 [ -0.08335842479770547, 0.26161158647062344, 0, 0.26161158647062355, 0.4198343797763849, 0.11095152519660606 ],
 [ -0.33703443303047603, 0, -0.22390016319069747, -0.19551707645726527, 0.3328545755898202, -0.27416252107096045 ],
 [ 0, -0.8602576059717225, -0.19551707645726527, 0.3328545755898202, -0.8166930252104408, 0.08226691676277925 ],
 [ 0.29932300975054993, -0.698709881031355, 0.11095152519660674, 0.2625734450660794, -0.3090833860848678, -0.20347658649113318 ],
 [ 0.30767572811682514, -0.11095152519660606, -0.27995705907340107, -0.3090833860848678, 0.20347808144150525, 0.22089662694677964 ],
 ],
 [ [ 0.307675728116825, 0.8602576059717231, 0, -0.29932300975054926, 0.8108685326909153, 0.11095152519660606 ],
 [ -0.29932300975054976, 0, 0.2239001631906974, -0.30767572811682525, 0.11095152519660756, 0.8166930252104414 ],
 [ 0, -0.8225461826917961, -0.30767572811682486, 0.11095152519660674, -0.27416252107096045, -0.3090833860848678 ],
 [ 0.2993230097505496, 0.3076757281168252, 0.11095152519660674, -0.8108984872080003, 0.3090833860848678, 0.20347808144150525 ],
 [ 0.30767572811682453, -0.3328545755898197, -0.27995705907340107, -0.08226691676277925, -0.6104327493741437, 0.6627401051461667 ],
 [ -0.11095152519660606, -0.2799570590734017, -0.7004336889325147, -0.20347509154076113, 0.22089662694677964, 0.5668603695138725 ],
 ],
 ],
 ];

  var n = 3;

  for (var x = -n; x < n; ++x) {
    for (var y = -n; y < n; ++y) {
      for (var z = -n; z < n; ++z) {
        for (var w = -n; w < n; ++w) {
          var actual = simplex.noise4D(x, y, z, w);
          var expected = expectedArray[x + n][y + n][z + n][w + n];

          t.equal(actual, expected);
        }
      }
    }
  }
  t.end();
});
